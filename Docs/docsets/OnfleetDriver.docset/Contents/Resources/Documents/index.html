<!DOCTYPE html>
<html lang="en">
  <head>
    <title>OnfleetDriver  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>


    <a title="OnfleetDriver  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          Onfleet Driver SDK for iOS
        </a>
         (44% documented)
      </p>
    
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/onfleet/ios-driver-sdk">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">OnfleetDriver Reference</a>
      <img class="carat" src="img/carat.png" />
      OnfleetDriver  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Driver%20Context.html">Driver Context</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DriverContext.html">DriverContext</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Config.html">Config</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Session.html">Session</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SessionManaging.html">SessionManaging</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Account.html">Account</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LogoutReason.html">LogoutReason</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/InvitationResponse.html">InvitationResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Credentials.html">Credentials</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PhoneNumber.html">PhoneNumber</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Driver.html">Driver</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DriverManaging.html">DriverManaging</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Driver.html">Driver</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Task.html">Task</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Task/Requirements.html">– Requirements</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Organization.html">Organization</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Organization/Billing.html">– Billing</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Vehicle.html">Vehicle</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Address.html">Address</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Recipient.html">Recipient</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Destination.html">Destination</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Barcode.html">Barcode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/CompletedTasksProviding.html">CompletedTasksProviding</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompletedTask.html">CompletedTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompletedTask/Requirements.html">– Requirements</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompletedTask/CompletionDetails.html">– CompletionDetails</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompletedTask/RecipientContainer.html">– RecipientContainer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompletedTask/ComputedContainer.html">– ComputedContainer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompletedTask/Attachment.html">– Attachment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TaskCompletionDetails.html">TaskCompletionDetails</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TaskCompletionDetails/AgeVerification.html">– AgeVerification</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TaskCompletionDetails/Result.html">– Result</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Location.html">Location</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/LocationManaging.html">LocationManaging</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Attachments.html">Attachments</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AttachmentsManaging.html">AttachmentsManaging</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AttachmentsDelegate.html">AttachmentsDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ImageAttachment.html">ImageAttachment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PhotoAttachments.html">PhotoAttachments</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SignatureAttachment.html">SignatureAttachment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ImagePreparationResult.html">ImagePreparationResult</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Observables.html">Observables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ObservableModel.html">ObservableModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Model.html">Model</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ModelProperty.html">ModelProperty</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ArrayModelProperty.html">ArrayModelProperty</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EquatableModelProperty.html">EquatableModelProperty</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EquatableOptionalModelProperty.html">EquatableOptionalModelProperty</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Guides.html">Other Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="basic-usage.html">Basic Usage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation.html">Installation</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Global%20Variables.html">Other Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Global%20Variables/SessionDidLogOutReasonKey.html">SessionDidLogOutReasonKey</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Enums.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/AnalyticsError.html">AnalyticsError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/CompleteTaskError.html">CompleteTaskError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/CompletedTasksError.html">CompletedTasksError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/DataState.html">DataState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/DutyStatusError.html">DutyStatusError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/FetchingState.html">FetchingState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/FileLocation.html">FileLocation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/HTTPError.html">HTTPError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/HttpApi.html">HttpApi</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/HttpApi/ApiError.html">– ApiError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LoginError.html">LoginError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LoginStatus.html">LoginStatus</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LogoutError.html">LogoutError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/RecipientContactMode.html">RecipientContactMode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ResetPasswordError.html">ResetPasswordError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SelfAssignError.html">SelfAssignError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/StartTaskError.html">StartTaskError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/UnitSystem.html">UnitSystem</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/UpdateProfileError.html">UpdateProfileError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/VehicleType.html">VehicleType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CLLocationCoordinate2D.html">CLLocationCoordinate2D</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Notification.html">Notification</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Notification/Name.html">– Name</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Structs.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AnalyticsStorgateFileName.html">AnalyticsStorgateFileName</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/BarcodeRequest.html">BarcodeRequest</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompletedTaskStats.html">CompletedTaskStats</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DriverLicense.html">DriverLicense</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DriverProfileDetails.html">DriverProfileDetails</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DriverProfileDetails/Vehicle.html">– Vehicle</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DriverProfileDetails/Value.html">– Value</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Metadata.html">Metadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Metadata/ValueType.html">– ValueType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Metadata/Visibility.html">– Visibility</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <p><img src="https://user-images.githubusercontent.com/500145/104442724-bdef5980-5595-11eb-90f7-4ddf726a9979.png" alt="Onfleet Driver SDK for iOS"></p>

<p><a href="https://img.shields.io/badge/pod-1.9.3-orange.svg"><img src="https://img.shields.io/badge/pod-1.9.3-orange.svg?style=flat" alt="CocoaPods Compatible"></a>
<a href="https://developer.apple.com/swift/"><img src="https://img.shields.io/badge/Swift-5.3-orange.svg?style=flat" alt="Swift 5.3"></a>
<a href="https://developer.apple.com/swift/"><img src="https://img.shields.io/badge/platform-iOS-orange.svg?style=flat" alt="Platform iOS"></a>
<a href="https://github.com/twilio/twilio-verify-ios/blob/main/LICENSE"><img src="https://img.shields.io/badge/License-Apache%202-blue.svg?logo=law" alt="License"></a></p>
<h2 id='table-of-contents' class='heading'>Table of Contents</h2>

<ul>
<li><a href="#About">About</a></li>
<li><a href="#Dependencies">Dependencies</a></li>
<li><a href="#Requirements">Requirements</a></li>
<li><a href="#Documentation">Documentation</a></li>
<li><a href="#Installation">Installation</a></li>
<li><a href="#Integration">Integration</a></li>
<li><a href="#SampleApp">Sample app</a></li>
</ul>

<p><a name='About'></a></p>
<h2 id='about' class='heading'>About</h2>

<p>Onfleet Driver SDK allows you to use Onfleet services directly in your iOS app. </p>

<p><a name='Dependencies'></a></p>
<h2 id='dependencies' class='heading'>Dependencies</h2>

<p>We currently use several dependencies. Our goal is to remove all of them in future releases of the SDK.</p>

<ul>
<li>SocketRocket</li>
<li>UICKeychainStore</li>
<li>RxSwift</li>
</ul>

<p><a name='Requirements'></a></p>
<h2 id='requirements' class='heading'>Requirements</h2>

<ul>
<li>iOS 12+</li>
<li>Swift 5.3</li>
<li>Xcode 12.5+</li>
</ul>

<p><a name='Documentation'></a></p>
<h2 id='documentation' class='heading'>Documentation</h2>

<p>This repository contains auto-generated documentation. See <code>onfleet-driver-sdk/Docs/index.html</code>.</p>

<p><a name='Installation'></a></p>
<h2 id='installation' class='heading'>Installation</h2>
<h3 id='cocoapods' class='heading'>CocoaPods</h3>

<p><a href="https://cocoapods.org">CocoaPods</a> is a dependency manager for Cocoa projects. For usage and installation instructions, visit their website. </p>

<p>To integrate Onfleet Driver SDK into your Xcode project using CocoaPods, specify it in your <code>Podfile</code>:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'OnfleetDriver'</span><span class="p">,</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">'https://github.com/onfleet/ios-driver-sdk.git'</span>

<span class="nb">puts</span> <span class="s2">"********** PODS POST INSTALLATION HOOK **********"</span>
  <span class="n">post_install</span> <span class="k">do</span> <span class="o">|</span><span class="n">pi</span><span class="o">|</span>
      <span class="n">pi</span><span class="p">.</span><span class="nf">pods_project</span><span class="p">.</span><span class="nf">targets</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">target</span><span class="o">|</span>
        <span class="n">target</span><span class="p">.</span><span class="nf">build_configurations</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
          <span class="n">config</span><span class="p">.</span><span class="nf">build_settings</span><span class="p">[</span><span class="s1">'IPHONEOS_DEPLOYMENT_TARGET'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'12.0'</span>
          <span class="n">config</span><span class="p">.</span><span class="nf">build_settings</span><span class="p">[</span><span class="s1">'BUILD_LIBRARY_FOR_DISTRIBUTION'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'YES'</span>
        <span class="k">end</span>
      <span class="k">end</span>
  <span class="k">end</span>
</code></pre>

<p>Please note that post installation hook is required at the moment to make sure that dependencies have target iOS 12 and to assure smooth linking during runtime library evolution must be enforced on all libraries. See <a href="https://github.com/CocoaPods/CocoaPods/issues/9775">https://github.com/CocoaPods/CocoaPods/issues/9775</a>.</p>
<h3 id='spm-amp-manually' class='heading'>SPM &amp; Manually</h3>

<p>Unfortunatelly we don&rsquo;t currently support SPM or manual integration.</p>

<p><a name='Integration'></a></p>
<h2 id='integration' class='heading'>Integration</h2>

<p>Apps powered by Onfleet SDK require collecting user location while the driver is on duty. Often iOS system kills backgrounded apps due to memory preassure so in case of background termination app must be woken up on the backgorund asap and continue collecting locations. This is achieved by combination of multiple techniques especially <code>background location updates</code>, <code>silent push notifications</code> and correct <code>location permissions</code> granted by user. </p>
<h3 id='1-background-execution' class='heading'>1. Background execution</h3>

<p>To achieve correct results pls enable in your Xcode project under your app schemes following background mode capabilities:</p>

<ol>
<li>Location Updates</li>
<li>Remote Notifications</li>
</ol>
<h3 id='2-location-permissions' class='heading'>2. Location permissions</h3>

<p>Following location permissions are required:</p>

<ol>
<li>Location -&gt; Allow location access -&gt; <strong>Always</strong></li>
<li>Precise Location -&gt; <strong>On</strong>
This will be referred as <em>full location permissions</em> going forward.</li>
</ol>

<p>Following privacy description must be set in <code>Info.plist</code></p>
<pre class="highlight plaintext"><code>&lt;key&gt;NSLocationAlwaysAndWhenInUseUsageDescription&lt;/key&gt;
&lt;string&gt;Onfleet only tracks your location when on-duty in order to provide analytics and dispatch work to you.&lt;/string&gt;
</code></pre>

<p>Unfortunatelly, current iOS permissions policy does not open apps in the background if location access is set to <strong>While in Use</strong> or <strong>Once</strong>. This requires apps to ask <em>full location permissions</em>. Asking this is sensitive and it is up to SDK integrator to design a flow that is suitable for their users. </p>

<p>Please follow these rules when implementing your own flow:</p>

<ol>
<li>enforce &ldquo;Always&rdquo; no sooner than when going on duty. Don&rsquo;t allow going on duty unless <em>full location permissions</em> are granted.</li>
<li>if driver revokes <em>full location permissions</em> while on duty make sure she goes either off duty or grants <em>full location permissions</em>.<br></li>
</ol>

<p>Good practice is to verify permissions before driver attempts to go on duty and present a screen with reasons why these permissions are required. Then app should request access <em>when in use</em> or <em>always</em>, then guide user to open Settings app and manually select location access <strong>Always</strong>. If precise location is off, similar flow should ask for precise location to be <strong>on</strong>.</p>

<p>Here are reasons why Onfleet requires <em>full location permissions</em>:</p>

<ol>
<li>dispatchers can see drivers in real time on web Dashboard</li>
<li>delivery recipients can see drivers in real time</li>
<li>task delivery ETA is continually recalculated to provide better precisions to recipients</li>
<li>locations are used for driver analytics, especially distance driven. Some drivers may be paid by according to this data so precision must be as accurate as possible.</li>
<li>SDK never tracks driver&rsquo;s location when off duty</li>
<li>system can open suspended application on background so it can continue sending locations to our server</li>
</ol>

<p>Protocol in <code>LocationManaging.swift</code> provides a conveniece wrapper for observing location permissions. Our Sample app contains an example flow.  </p>
<h3 id='push-notifications' class='heading'>Push notifications</h3>

<p>When SDK is initialized it automatically registers for remote notifications. Host app is however responsible for managing push notifications and delivering them to the SDK through methods defined in <code><a href="Classes/DriverContext.html">DriverContext</a></code> class. If push notifications will not be forwarded several features will stop working (including device provisioning) or will not work as expected.</p>

<p><a name='SampleApp'></a></p>
<h2 id='sample-app' class='heading'>Sample app</h2>

<p>This repository contains <code>Sample App</code> project that integrates Driver SDK. It provides an overview to core features and guides on how to use them in code. Following features are currently supported:</p>

<ul>
<li>Log in, log out, reset password</li>
<li>Accepting / rejecting invitations</li>
<li>Setting duty status</li>
<li>Fetching data</li>
<li>Tasks list</li>
<li>Task detail (claiming, starting, completing tasks)</li>
</ul>
<h3 id='set-up' class='heading'>Set up</h3>

<ol>
<li>clone <code>onfleet/ios-driver-sdk</code> repository using  <code>git clone git@github.com:onfleet/ios-driver-sdk.git</code></li>
<li>open root directory and install pods using <code>pod install</code></li>
<li>open <code>SampleApp.xcworkspace</code> in Xcode</li>
<li>in <code>AppDelegate.swift</code> file add your Onfleet <strong>application_id</strong></li>
<li>in target&rsquo;s Signing &amp; Capabilities update bundle identifier and team</li>
<li>build and run using <code>SampleApp</code> scheme</li>
</ol>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>© 2021 Onfleet, Inc.</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
